***chapter5 <大而快-层次化存储>***
# 5.1 Basis
## 5.1.0 标准术语
- 带宽 Bandwidth
	传输数据的字节数/周期数
- 总线 BUS
	总线（Bus）是计算机各种功能部件之间传送信息的公共通信干线
	**总线（Bus）是计算机各种功能部件之间传送信息的公共通信干线**，它是由导线组成的传输线束， 按照计算机所传输的信息种类，计算机的系统总线可以划分为 数据总线 、 地址总线 和 控制总线，分别用来传输数据、数据地址和 控制信号。

## 5.1.1 IEC Standard Prefixes

| Name  | Abbr | Factor   | SI size   |
| :---: | :--: | :------- | :-------- |
| Kilo  |  K   | $2^{10}$ | $10^{3}$  |
| Mega  |  M   | $2^{20}$ | $10^{6}$  |
| Giga  |  G   | $2^{30}$ | $10^{9}$  |
| Tera  |  T   | $2^{40}$ | $10^{12}$ |
| Peta  |  P   | $2^{50}$ | $10^{15}$ |
|  Exa  |  E   | $2^{60}$ | $10^{18}$ |
| Zetta |  Z   | $2^{70}$ | $10^{21}$ |
| Yotta |  Y   | $2^{80}$ | $10^{24}$ |
## 5.1.2 局部性
- 时间局部性 Temporal locality
	在**相邻时间**内 访问**同一个内存单元**
- 空间局部性
	访问存储单元 操作地址连续(同时被访问)
- 所以访问内存地址 局部、范围小

## 5.1.3  存储层次结构(memory hierarchy)
- 使用多级存储器，对着与CPU距离增加，存储器的容量和访问时间都会增加，但是每bit的成本降低，具体如下:
0. CPU
1. Cache-SRAM 易失性 只需要mos管的电平变化、所以数据交流快
2. Memory DRAM 易失性
3. Disk Flash(闪存一般应用在固态硬盘中) & Meganetic disk 机械硬盘 **非易失性**
- $Cache\Leftrightarrow Memory$  交换数据 以“块”为单位(cache行)
- $Memory \Leftrightarrow Disk$ 交换数据 以“块”为单位(页page)

## 5.1.4 temp
- CPU 给出Read/Write 控制信号
	- Read信号 CPU等待数据
	- Write信号 CPU给出数据 等待写数据操作完成

# 5.2 SRAM&DRAM
## 5.2.1 SRAM
- 易失性存储
	![[Pasted image 20241213113940.png]]
- 解释:
	M3-导通 M1-截止 表示1
	M3-截止 M1-导通 表示0
	wl(wordline) 字线
	bl(bitline) 位线
## 5.2.2 DRAM
- 非易失性存储
	![[Pasted image 20241213114240.png]]
- 解释:
	- Storage Capacitor 为1 即为有电荷存在 
	- 写操作 先将wl连通, 然后bl对Capacitor电容来充电或者放电
	- 读操作(具有破坏性)先连通wl, 然后查看bl线上是否有微弱电流流过(要经过放大器放大)因为**读取过程**中会**造成电荷流失**,所以还要进行充电操作
	- 速度慢 -因为需要进行充电放电操作
	- 缺点
		电容上的电荷会随着时间而丢失
		所以每隔2ms 要进行周期性的刷新(相当于读操作) 所以要增加刷新电路(计时以及其他功能) 刷新的优先级高 如果此时CPU要访问数据 那么需要等到刷新完成
	- 提高性能
		1. 突发方式(burst mode) -SDRAM 在总线上
			周期分为2T
			T1 给出地址数据
			T2 读写数据
			Example(读取四个连续地址的数据):
				读第一个地址中的数据需要完整的2T
				而之后的三个地址,只需要在原先的地址上逐级+4每个T 直接读取数据
				所以最后只需要5T
		2. 双倍的数据速率 -DDR
			在一个周期的上升沿和下降沿都读取数据
		3. 四倍速动态随机存储 -QDR
			在CPI总线上处理
			CPU不需要等待
			T的前半部分就用来给出地址
		4. 多体交叉存储器
			编址交叉
			Example(四体交叉):
				首体地址末尾为00,提供地址的高30位即可
				一个周期T就可以读取(对齐存储)
				小端存储 低位数据存在低地址位
				bank1(00) | bank2(01) | bank3(10) | bank4(11)
			![[Pasted image 20241106152034.png]]
			对于四个32位的连续地址
			- a = 4 * (1 +15 + 1)T
			- b = (1 + 15 + 1)T
			- c = (1 + 15 + 4 * 1)T
			
# 5.3 Flash&Disk storage
## 5.3.1 Flash storage 固态硬盘
均衡写
- 使用次数有限制 与二氧化硅的厚薄有关
- 分类
	- NOR flash--按照bit存储
	- NAND flash--以块位单位存储,先清空erase再写入数据
## 5.3.2 Disk storage 机械硬盘
- 又被称为温盘(温切斯特盘)
	- 根据磁性方向来判断1 or 0
	- 利用磁性材料存储信息
	- 磁道track -> 扇区sector ![[Pasted image 20241214195844.png]]
- 读取方式
	1. 定位磁道 寻道
		可以假象为小车
	2. 旋转
		将想要的扇区转到磁头下方
	3. 读数据(扇区)
- 数据的存储方式
	![[Pasted image 20241214200354.png]]
	ID在格式化的时候设置
	G(gap)方便磁头对准

# 3.2 数值操作
## 1. 整数
- 以二进制补码的形式存储数据、机器字长固定、使其可以循环
	分为有符号数与无符号数
## 2. 小数
- 遵循**IEEE754标准**
	**单精度float**
	**双精度double**
	可以由ALU运算器完成相对应运算
	**但是**效率低，所以使用**协处理器**完成浮点数运算
## 3. OverFlow
- Adding +ve and -ve operands
	**No OverFlow**
- Adding **two+ve** operands
	**OverFlow** if **result sign is 1**
- Adding **two -ve** operands
	**OverFlow** if **Result sign is 0**